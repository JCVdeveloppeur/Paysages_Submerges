{% extends 'admin/layout.html.twig' %}

{% block page_title %}Administration des esp√®ces{% endblock %}
{% block page_heading %}üêü G√©rer les esp√®ces{% endblock %}

{% block content %}
<div class="admin-surface">

  {# ===== HEAD ===== #}
  <div class="admin-surface__head">
    <div class="d-flex align-items-center gap-2 flex-wrap">
      <h3 class="mb-0"> Fiches esp√®ces</h3>
      <span class="badge bg-primary">{{ nombreEspeces }}</span>
    </div>

    <div class="d-flex align-items-center gap-2 flex-wrap">
      {% if especes is not empty %}
        <form method="get" class="d-flex align-items-center gap-2 m-0">
          <input type="hidden" name="page" value="1">
          <label class="visually-hidden" for="limitSelect">Limite</label>
          <select id="limitSelect"
                  name="limit"
                  class="form-select form-select-sm admin-select-glass"
                  onchange="this.form.submit()">
            <option value="5"  {{ limit == 5 ? 'selected' }}>5</option>
            <option value="10" {{ limit == 10 ? 'selected' }}>10</option>
            <option value="20" {{ limit == 20 ? 'selected' }}>20</option>
          </select>
        </form>
      {% endif %}

      <a href="{{ path('admin_espece_new') }}" class="btn-admin-ajouter">
        <i class="bi bi-plus-circle"></i> Ajouter une esp√®ce
      </a>

      <a href="{{ path('admin_dashboard') }}" class="btn btn-outline-light">
        <i class="bi bi-speedometer2"></i> Tableau de bord
      </a>
    </div>
  </div>

  {# ===== BODY ===== #}
  <div class="admin-surface__body">
    {% if especes is empty %}
      <div class="alert alert-warning mb-0">
        Aucune esp√®ce enregistr√©e pour le moment.
      </div>
    {% else %}
      <div class="table-responsive">
        <table class="table admin-table-glass align-middle">
          <thead>
            <tr>
              <th>#</th>
              <th>Nom commun</th>
              <th>Nom scientifique</th>
              <th>Type</th>
              <th>Biotope</th>
              <th class="text-end">Actions</th>
            </tr>
          </thead>

          <tbody>
            {% for espece in especes %}
              <tr>
                <td>{{ espece.id }}</td>
                <td>{{ espece.nomCommun|default('‚Äî') }}</td>
                <td><em>{{ espece.nomScientifique|default('‚Äî') }}</em></td>
                <td>
                  {% if espece.typeEspeceLabel %}
                    <span class="badge-type type--{{ espece.typeEspeceCss }}">{{ espece.typeEspeceLabel }}</span>
                  {% else %}
                    ‚Äî
                  {% endif %}
                </td>
                <td>{{ espece.biotope|default('‚Äî') }}</td>
                <td class="text-end">
                  {% include 'admin/_actions_row.html.twig' with {
                  edit_path: path('admin_espece_edit', { id: espece.id }),
                  delete_path: path('admin_espece_delete', { id: espece.id }),
                  csrf_token_id: 'delete-espece-' ~ espece.id,

                  delete_kind: 'espece',
                  delete_kicker: "Suppression d'esp√®ce",
                  delete_title: "Supprimer la fiche esp√®ce ?",
                  delete_subtitle: "Cette fiche ne sera plus accessible.",
                  delete_body: "Vous √™tes s√ªr de vouloir supprimer : <strong>" ~ (espece.nomCommun|default('cette esp√®ce'))|e('html_attr') ~ "</strong> ?"
                } %}
                </td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    {% endif %}
  </div>

  {# ===== FOOT ===== #}
  <div class="admin-surface__foot d-flex justify-content-between align-items-center flex-wrap gap-3">
    {% if especes is not empty %}
      <div class="admin-pagination-glass">
        {{ knp_pagination_render(especes) }}
      </div>
    {% endif %}
  </div>

</div>
{% endblock %}






